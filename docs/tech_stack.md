# 裏星アプリ 技術スタック設計

## 🎯 技術選定の方針
- **開発速度重視**: 早期リリースを目指す
- **スケーラビリティ**: ユーザー増加に対応
- **コスト効率**: 初期コストを抑えつつ成長対応
- **メンテナンス性**: 長期運用を考慮

## 📱 フロントエンド

### モバイルアプリ
**React Native** (推奨)
- ✅ iOS/Android 同時開発
- ✅ JavaScriptベースで開発速度◎
- ✅ リッチなUI/アニメーション対応
- ✅ プッシュ通知、決済連携が容易

**代替案**: Flutter
- Dart言語の学習コストあり
- パフォーマンスは若干上

### ランディングページ
**Next.js 14** (推奨)
- ✅ SEO対応（SSR/SSG）
- ✅ TypeScript標準対応
- ✅ Vercel簡単デプロイ
- ✅ アプリとのAPI共有可能

## 🔧 バックエンド

### API サーバー
**Node.js + Express + TypeScript**
- ✅ フロントエンドと言語統一
- ✅ 豊富なライブラリエコシステム
- ✅ リアルタイム処理（Socket.io）対応
- ✅ 占い計算ライブラリの豊富さ

### 認証
**Supabase Auth** または **Auth0**
- ✅ ソーシャルログイン対応
- ✅ セキュリティベストプラクティス
- ✅ 実装コスト削減

### データベース
**PostgreSQL + Supabase**
- ✅ JSONB型でフレキシブルなデータ管理
- ✅ リアルタイム機能内蔵
- ✅ 管理画面付き
- ✅ 無料枠から始められる

## 🤖 AI・占い機能

### AI対話
**OpenAI GPT-4** + **Custom Instructions**
- ✅ 高品質な自然言語処理
- ✅ キャラクター別プロンプト管理
- ✅ 感情分析機能

### 占い計算エンジン
**カスタム実装 (Node.js)**
- 占星術: `ephemeris` NPMパッケージ
- タロット: カード選択ロジック自作
- 四柱推命: 干支計算ライブラリ

## 💰 決済・収益化

**Stripe**
- ✅ サブスクリプション対応
- ✅ 日本の決済手段豊富
- ✅ 詳細な分析機能
- ✅ React Native対応

## 📊 分析・監視

### アプリ分析
**Firebase Analytics** + **Mixpanel**
- ユーザー行動分析
- コンバージョン追跡

### エラー監視
**Sentry**
- リアルタイムエラー通知
- パフォーマンス監視

## 🚀 インフラ・デプロイ

### ホスティング
- **API**: Railway または Render
- **Web**: Vercel
- **モバイル**: App Store / Google Play

### CI/CD
**GitHub Actions**
- 自動テスト
- 自動デプロイ
- コード品質チェック

## 💾 ファイル・画像管理

**Supabase Storage** または **Cloudinary**
- タロットカード画像
- モンスターイラスト
- ユーザーアバター

## 📦 主要ライブラリ・パッケージ

### フロントエンド (React Native)
```json
{
  "@react-navigation/native": "^6.x",
  "react-native-reanimated": "^3.x",
  "react-native-vector-icons": "^10.x",
  "react-native-svg": "^13.x",
  "lottie-react-native": "^6.x",
  "@react-native-async-storage/async-storage": "^1.x"
}
```

### バックエンド (Node.js)
```json
{
  "express": "^4.x",
  "typescript": "^5.x",
  "prisma": "^5.x",
  "openai": "^4.x",
  "stripe": "^13.x",
  "zod": "^3.x",
  "helmet": "^7.x"
}
```

### 占い計算
```json
{
  "ephemeris": "^1.x",
  "moment-timezone": "^0.5.x",
  "lunar": "^2.x"
}
```

## 🔄 開発フェーズ計画

### フェーズ1: MVP (4-6週間)
- [ ] 基本認証機能
- [ ] シンプルなタロット占い
- [ ] わるいこノート基本機能
- [ ] 1つのモンスター

### フェーズ2: 機能拡張 (6-8週間)
- [ ] 占星術・四柱推命追加
- [ ] 複数モンスター
- [ ] 履歴・統計機能
- [ ] プッシュ通知

### フェーズ3: 収益化 (4-6週間)
- [ ] サブスクリプション
- [ ] プレミアム占い
- [ ] モンスター課金

### フェーズ4: 成長・改善 (継続)
- [ ] A/Bテスト
- [ ] 新機能追加
- [ ] パフォーマンス最適化

## 💡 開発のポイント

1. **モジュラー設計**: 機能ごとに独立したモジュール化
2. **型安全性**: TypeScript徹底活用
3. **テスト**: 重要機能から段階的にテストカバー
4. **ドキュメント**: API仕様書・運用手順の整備
5. **監視**: エラー・パフォーマンス・ビジネスメトリクス 